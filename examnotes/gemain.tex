




\subsection{Setup}

We study here an exchange economy with no production. There are a
finite number of agents $i$ and commodities $l$. A consumption bundle
is a bundle of commodities $x \in \R^L_+$. Each agent has an endowment
$\omega^i \in \R^L_+$ and a utility function $u^i : \R^L_+ \to \R$. We
denote an economy as a set of endowments and utlity functions
\[
{\cal E} = \{(u^i, \omega^i)\}
\]
thus at prices $p$ the agent has a budget set $B^i(p) = \{x : p \cdot
x \leq p \cdot \omega^i\}$ hence each agent solves
\[
\max_{x \in B^i(p)} u^i(x)
\]

\begin{definition}[Walrasian Equilibrium]
  A Walrasian equilibrium for economy ${\cal E}$ is a pair $(p,
  \{x^i\}_{i \in I})$ such that
  \begin{enumerate}[(i)]
  \item Agents maximize utility under prevailing prices:
    \[
    \forall i \in I, x^i \in \arg \max_{x \in B^i(p)} u^i(x)
    \]
  \item Markets clear for each good:
    \[
    \forall l \in {\cal L}, \sum_{i \in I} x^i_l = \sum_{i \in I} \omega^i_l
    \]
  \end{enumerate}
\end{definition}

\begin{definition}
  An allocation $\{x^i\}_{i \in I}$ is feasible if
  \[
  \forall l \in {\cal L}, \sum_{i \in I} x^i_l \leq \sum_{i \in I} \omega^i_l
  \]
\end{definition}

Note that the equilibrium only cares about relative, not absolute
prices.

\begin{prop}
  If the market for one clears, then the other markets clear as well.
\end{prop}

\begin{definition}[Pareto Optimal]
  Given an economy ${\cal E}$, a feasible allocation $x$ is Pareto
  optimal/efficient if there is no other feasible allocation $\hat x$
  such that
  \begin{enumerate}[(i)]
  \item $\forall i \in I, u^i(\hat x^i) \geq u^i(x^i)$
  \item $\exists i \in I: u^i(\hat x^i) > u^i(x^i)$
  \end{enumerate}
\end{definition}

\subsection{The Four Assumptions}
\label{sec:four-assumptions}

We make the following assumptions on preferences on each agent $i$,
termed \textbf{\textit{the four assumptions}}:

\begin{enumerate}
\item $u^i$ is continuous
\item $u^i$ is increasing in $x$
\item $u^i$ is concave
\item $\omega^i >> 0$
\end{enumerate}

The first three are similar to what we've always used. The last is
important, new, and strong. It can be used to eliminate odd corner
solutions.


\subsection{A $2 \times 2$ Exchange Economy}
\label{sec:2-times-2}


For simplicity we now study the pure exchange economy described above
in the limited case where there are two consumers and two goods. This
lends itself to easy study by use of an Edgeworth box. We use the
following definitions in the context of this exchange economy

\begin{definition}[Allocation]
  An allocation $x$ assigns a nonnegative consumption vector to each consumer
  \[
  x = (x^1, x^2) = ((x^1_1, x^1_2), (x^2_1, x^2_2))
  \]
\end{definition}

\begin{definition}[Feasible]
  An allocation is feasible if $\forall l = 1, 2$
  \[
  x^1_l + x^2_l \leq \omega^1_l + \omega^2_l
  \]
\end{definition}

\begin{definition}[Non-Wasteful]
  An allocation is nonwasteful if
  \[
  x^1 + x^2 = \omega
  \]
\end{definition}

\begin{definition}[Budget Set]
  The budget set for consumer $i$ is given by
  \[
  B^i(p) = \{x \in \R^2_+: p \cdot x \leq p \cdot \omega^i\}
  \]
  where, in general, the budget set may extend outside of the
  Edgeworth box.
\end{definition}

\begin{definition}[Offer Curve]
  Given a fixed exchange economy ${\cal E}$ (fixed endowments and
  utility functions), the offer curve for consumer $i$ is generated by
  adjusting $p$ and for each $p$ tracing out the feasible allocation
  that maximizes consuemr $i$'s utility, thus generating a curve. 
\end{definition}

Note that the consumer's endowment will always be affordable, so the
offer curve must lie above the indifference curve passing through the
endowment.

\begin{definition}[Excess Demand]
  Total agent demand for a commodity is greater than what is available
  in the economy (corner solution).
\end{definition}

\begin{definition}[Pareto Set]
  Allocations where indifference curves of the two consumers are
  tangent. They are characterized by
  \[
  \frac{
    \frac{\partial u^1}{\partial x^1}
  } {
    \frac{\partial u^1}{\partial x^2}
  }
  (x^1)
  =
  \frac{
    \frac{\partial u^2}{\partial x^1}
  } {
    \frac{\partial u^2}{\partial x^2}
  } (\omega - x^1)
  \]
\end{definition}

\begin{definition}[Contract Curve]
  The section of the Pareto set where each consumer does at least as
  well as her initial endowment.
\end{definition}

\subsection{Welfare Theorems}
\label{sec:welfare-theorems}



\begin{theorem}[First Welfare Theorem]
  Let $(p, \{x^i\}_{i \in I})$ be a Walrasian equilibrium for economy
  ${\cal E}$. If utility is increasing, then allocation $\{x^i\}_{i
    \in I}$ is Pareto optimal.
\end{theorem}

This says that even without explicit coordination, decentralized
markets where agents simply maximize their utilities given prices are
efficient. However, it should be emphasized that the model has a
number of heroic assumptions; e.g., agents face the same prices,
agents are price takers, markets exist for all goods, and we havenâ€™t
said where prices come from.

\begin{theorem}[Second Welfare Theorem]
  Let ${\cal E}$ satisfy our four assumptions. If $\{\omega^i\}_{i \in
    I}$ is Pareto optimal, then $\exists p \in \R^L_+$ such that $(p,
  \{\omega^i\}_{i \in I}$ is a Walrasian equilibrium for ${\cal E}$.
\end{theorem}

Note that the SWT does not say that starting from a given endowment,
every Pareto optimal allocation is a Walrasian equilibrium; rather, it
says if we start from a given endowment, then for any Pareto optimal
allocation, there is a way to redistribute resources and prices that
makes the allocation a Walrasian equilibrium outcome. That is, once we
find an efficient allocation, we could support it with a price
equilibrium. But in that case, why not simply implement it directly
without prices?


We now proceed with a sketch of the proofs for the Welfare
Theorems. We use the four assumptions given above, and additionally
make the simplifying assumption that $\nabla u^i(x^i) > 0$ and that
$u^i(0) = 0$. 

\begin{definition}[Utility Possibility Set]
  The utility possibility set (UPS) is given by
  \[
  {\cal U} = \{u^1(x^1), \dots, u^l(x^l) : \sum x^i \leq \sum \omega^i \}
  \]
\end{definition}

Note that Pareto optimal allocations are those on the ``northeast''
frontier of the UPS. Now consider the following program
\begin{align}
  \max_{x^1} u^1(x^1) \quad s.t. & \quad u^i(x^i) \geq \bar u^i 
  & i = 2, \dots, I \notag \\
  & \quad \sum x^i_l \leq \sum \omega^i_l & l = 1, \dots, L \notag
\end{align}
then Pareto optimal allocations solve this program for different
values of $(\bar u^2, \dots, \bar u^l) \geq 0$. That is, we maximize
the utility of our first consumer subject to other consumers getting
at least some prespecificed level of utility each. Since we can vary
the required levels $\bar u$ we can recover the full set of Pareto
optimal outcomes. If we restrict our attention to $\bar u >> 0$, then
under our first three assumptions the utility constraints are binding;
if they weren't, we could reduce allocation to the slack constraint
and give it to consumer $1$ whose utility is increasing in $x^1$. Then
we can apply KT to get the Lagrangian
\[
\sum_{i \in I} \lambda^iu^i(x^i) 
+ \sum_{l \in L} \mu_l \left( \sum_{i \in I}\omega^i_l -  \sum_{i \in I} x^i_l \right)
\]
where by convention $\lambda^1 = 1$. And since all constraints bind,
$\lambda^i > 0$ and $\mu_l > 0$. So our FOCs are
\begin{enumerate}
\item $\lambda^i \frac{\partial u^i(x^i)}{\partial x^i_l} - \mu_l \leq 0$
\item $\left(\lambda^i \frac{\partial u^i(x^i)}{\partial x^i_l} -
    \mu_l\right)x^i_l \leq 0$
\item $x^i_l \geq 0$
\item $\sum_i x^i = \sum_i \omega^i$
\end{enumerate}
(note that we could also interpret this Lagrangian as arising from
maximizing a social welfare function subject to resource constraints).

Now we turn our attention not to Pareto optimal outcomes, but
competitive outcomes under Walrasian equilibria. Each consumer solves
the UMP under prices $p$:
\[
\max_{x^i} u^i(x^i) \quad s.t. \quad p \cdot x^i \leq p \cdot \omega^i
\]
which is a constrained optimization problem, so we use KT and let
$\gamma^i$ be the multiplier on the budget constraint. Then under
the FOCs are
\begin{enumerate}
\item $\frac{\partial u^i(x^i)}{\partial x^i_l} - \gamma^ip_l \leq 0$
\item $\left(\frac{\partial u^i(x^i)}{\partial x^i_l} -
    \gamma^ip_l\right)x^l_l = 0$
\item $x^i_l \geq 0$
\end{enumerate}
then $x$ can be supported as a price equilibrium if and only if we can
find vectors $p$ and $\gamma$ such that the above KT conditions
hold. But these KT conditions are exactly the same as on the Pareto
optimal outcome! This observation implies the two
welfare theorems.

\textbf{Proof of FWT.} If $\omega$ and $p$ are given and each agent
solves UMP, then at consumption bundles $\{x^i\}$ the UMP KT
conditions hold. Then if we let $\bar u^i = u^i(x^i), i = 2, \dots,
I$, and we define $\mu_l = p_l$ and $\lambda^i = (\gamma^i)^{-1}$ then
the KT conditions for the Pareto problem are also met. Hence any
Walrasian equilibrium is Pareto optimal.

\textbf{Proof of SWT.} If KT condtions for the Pareto program are
satisfied then we can define prices $p_l = \mu_l$ and multipliers
$\gamma^i = (\lambda^i)^{-1}$ and we therefore meet the KT conditions
for the UMP, hence $(p, x)$ Walrasian equilibrium with endowment
$\omega = x$.

Note that the above proof of the SWT gives the interpretation that the
supporting price vector $p$ is the vector of shadow prices $\mu$ on
the aggregate endowment of each good.




\subsection{Robinson-Crusoe: One-Producer, One-Consumer Economy}
\label{sec:robinson-crusoe}

Setup:
\begin{itemize}
\item two goods, leisure (1) and consumption good (2)
\item wage for labor $w$ and price of consumption good $p$ taken as
  exogenous
\item single consumer with endowment $\bar L$ of leisure and $0$ of
  the consumption good
\item single firm with strictly concave technology $f(z)$
\item consumer owns the firm and receives all profits
\end{itemize}

The firm therefore solves
\[
\max_z p f(z) - wz
\]
and we denote the optimal labor demand $z(p, w)$, the optimal output
level $q(p,w)$, and the optimal profits $\pi(p,w)$. 

The consumer solves
\[
\max_{x_1, x_2} u(x_1, x_2) \quad s.t. \quad px_2 \leq w(\bar L - x_1) + \pi(p, w)
\]

A Walrasian equilibrium in this economy is a price vector $(p^*, w^*)$
at which both markets clear, i.e.
\begin{align}
x_2(p^8, w^*) &= q(p^*, w^*) & \text{consumption market clears} \notag \\
z(p^*, w^*) = \bar L - x_1(p^*, w^*) & \text{labor market clears} \notag
\end{align}



\subsection{A $2 \times 2$ Production Economy}
\label{sec:2-times-2-prod}

Setup:

\begin{itemize}
\item $2$ goods and $2$ factors
  \begin{itemize}
  \item each firm produces a single good, i.e. two firms
  \item factor $1$ is labor, factor $2$ capital, with input prices $w$
    and $r$, respectively
  \item total endowment is $L$ and $K$, respectively
  \item goods prices $p_1, p_2$
  \end{itemize}
\item each firm has constant returns to scale (CRS) technology,
  i.e. $f(\lambda k, \lambda l) = \lambda f(k, l)$ and $c(w,r,q) = q
  c(w,r,1)$

\end{itemize}

Each firm $j$ then solves
\[
\max_{k_j, l_j} p_j f_j(k_j, l_j) - c_j(w, r, q_j)
\]
and under CRS the FOC is
\[
p = \frac{\partial c(w,r,q)}{\partial q} 
= \frac{\partial [qc(w,r,1)]}{\partial q} = c(w,r,1)
\]
however, this does not gives us a level of output (due to CRS). So we
move to per-unit analysis, and we get total cost for firm $j$ to
produce $q^j$ units is
\[
C^j(w, r, q^j) = 
\underbrace{\min\{wl + rk \; | \; f(k, l) \geq 1 \} }_{c^j(w,r) = \text{"unit cost"}}
\cdot q^j
\]
then we can denote $a^j_l(w,r)$ and $a^j_k(w,r)$ to be the per-unit
factor demands at given factor prices that solve the above cost
minimization problem.

\begin{lemma}[Shepard's Lemma]
  Under the above,
  \[
  \frac{\partial c^j(w,r)}{\partial w} = a^j_l(w,r)
  \]
  and
  \[
  \frac{\partial c^j(w,r)}{\partial r} = a^j_k(w,r)
  \]
\end{lemma}

For a given quantity $q^j$, firm $j$ therefore uses $a^j_lq^j$ units
of labor. ``Full employment conditions'' mandate that all available
labor and capital is employed, that is, with two firms:
\[
a^1_l q^1 + a^2_lq^2 = L
\]
and
\[
a^1_k q^1 + a^2_k q^2 = K
\]


\begin{definition}[Specialization]
  If only one good is produced is equilibrium, we say the economy is
  specialized.
\end{definition}

If we assume that there is no specialization and both goods are
produced, we have an interior solution and equilibrium factor prices
are determined by the FOCs
\[
p^1 = c^1(c^*, r^*) \quad p^2 = c^2(c^*, r^*)
\]


\begin{definition}[Intensive Production]
  We say that production of good $1$ is relative more intensive in
  labor than production of good $2$ if 
  \[
  \frac{a^1_l(w,r)}{a^2_l(w,r)} > \frac{a^1_k(w,r)}{a^2_k(w,r)}
  \quad \forall (w,r)
  \]
\end{definition}


\begin{theorem}[Samuelson 1949]
  Two countries with identical technologies facing the same product
  prices will have the same factor prices even if factor endowment
  differs (version of ``factor price equalization (FPE)'' theory by
  Samuelson).
\end{theorem}

\begin{theorem}[Stolper-Samuelson Theorem]
  Under the above economy, if $p_j$ increases, the equilibrium price
  of the factor more intensively used in the production of good $j$
  increases, while the price of the other factor decreases (assuming
  interior equilibria both before and after the price change).
\end{theorem}

\begin{theorem}[Rybcszynski Theorem]
  If the endowment of a factor increases, then the production of the
  good that uses this factor relatively more intensively increases,
  while the production of the other good decreases (assuming interior
  equilibria both before and after the price change).
\end{theorem}



\subsection{Public Goods}
\label{sec:public-goods}

We now return to Chapter 11 in MWG for discussion of public goods.

\begin{definition}[Public Good]
  A public good is a good for which use of a unit by one consumer does
  not preclude its use by others.
\end{definition}

\begin{definition}[Non-depletable/non-rivalrous/public]
  A good is non-depletable if one agent's consumption of the good does
  not subtract from any other agent's consumption of said good.
\end{definition}

\begin{definition}[Excludability]
  A public good is non-excludable if, once it has been provided to one
  consumer, it is impossible (or prohibitively costly) to prevent
  others from consuming it (e.g. a lighthouse). 
\end{definition}

\begin{definition}[Impure Public Good]
  An impure public good, or public good with congestion, is a good
  that can be shared, but eventually additional consumers impose
  negative externalities on others (e.g. a swimming pool).
\end{definition}

Public goods are interesting to study because common sense suggests
that they will be under-provided by the usual market mechanism.

\subsubsection{Neo-Classical Theory of Public Goods}

Setup:
\begin{itemize}
\item $n$ consumers indexed by $i = 1, \dots, n$
\item two goods -- a numeraire private good $x$ and public good $G$
\item consumer $i$ has utility $u^i(x^i, G)$ which is differentiable,
  increasing in both arguments, quasi-concave, and $u^i(x^i, 0) > 0$
  (which guarantees an interior solution)
\item consumer $i$ has endowment of numeraire $w^i$, and we denote $W
  = \sum_i w^i$
\item public good endowment is zero
\item $G = f(z)$, where $z$ is total units of private goods used as
  inputs
\end{itemize}

\begin{definition}[Allocation]
  An allocation for this community consists of
  \begin{enumerate}[(i)]
  \item A level public good $G$
  \item An allocation of private goods $x = (x^1, \dots, x^n)$
  \end{enumerate}
\end{definition}

\begin{definition}[Feasible]
  An allocation for this community is feasible if $\exists z \geq 0$ s.t.
  \begin{enumerate}[(i)]
  \item $z + \sum_i x^i \leq W$
  \item $G \leq f(z)$
  \end{enumerate}
\end{definition}


\begin{definition}[Pareto Optimality/Lindahl-Samuelson Condition]
  An allocation $(x, G)$ is Pareto optimal if and only if
  \[
  \sum_{i=1}^n 
  \frac{
    \frac{\partial u^i(x^i, g)}{\partial G}
  } {
    \frac{\partial u^i(x^i, G)}{\partial x^i}
  }
   = \frac{1}{f'(z)}
  \]
\end{definition}

The above is know as the \textit{Lindahl-Samuelson Condition}. It says
that the sum of the marginal rates of substitutions between the agents
is equal to the amount of private good required to produce an
additional unit of the public good.




\subsubsection{Market Provision of Public Goods}

Setup:
\begin{itemize}
\item public good has price $p$
\item agents choose how much to buy, $g^i$
\item single price-taking, profit-maximizing firm that produces public
  good
\end{itemize}

The issue is that we have a \textit{strategic problem}, since the
amount demanded by each agent depends on what she expects other agents
to demand (note that all agents uniformly enjoy total $G$ that the
firm produces).

\begin{definition}[Competitive Equilibrium]
  A competitive equilibrium in this contetx consists of $p^*$ and $G^*
  = (g^{1*}, \dots, g^{n*})$ s.t.
  \begin{enumerate}[(i)]
  \item Each agent's choice $g^i$ maximizes utility given $p^*$ and
    $g^*_{-i}$
  \item The firm optimizes
    \[
    \max_{z \geq 0} p^* f(z) - z
    \]
    which is equivalent to
    \[
    p^* = \frac{1}{f'(f^{-1}(\sum g^{i*})}
    \]
  \end{enumerate}

\end{definition}


\begin{prop}
  In the above competitive equilibrium, there is under-provision of
  the public good relative to the level prescribed by the Lindahl-Samuelson
  condition.
\end{prop}

The intuition is that we have a \textit{free-rider} problem, i.e. each
agent free rides on others' provisions, and does not consider the
benefit to other agents of the output that she purchased.

\subsubsection{Lindahl Equilibrium and Personalized Prices}

In this model, we assume that somehow the public good is excludable
and can be offered to each agent at a different ``personalized
price.'' We also assume that agents own the firm that produces the
public good, with agent $i$'s share in the firm's profits given by
$s^i \in [0,1]$ with $\sum_i s^i = 1$.

\begin{definition}[Personalized Price]
  An agent's personalized price is a price $p^i$ that the agent faces
  to purchase one unit of the public good, and can differ across
  agents.
\end{definition}

We can select personalized prices such that agents all agree on the
level of the public good $G$. This fictitious economy has $n+1$ goods,
the private good (which is the same for everybody) plus the $n$
personalized public goods.


\begin{definition}[Lindahl Equilibrium]
  A Lindahl equilibrium is a vector $p^* = (p^{1*}, \dots, p^{n*})$
  and allocation $x^{1*}, \dots, x^{n*}, G^*$ s.t.
  \begin{enumerate}[(i)]
  \item The firm maximizes total profits:
    \[
    G^* = \arg \max_{G \geq 0} \left(\sum_i p^{i*}\right)G - f^{-1}(G)
    \]
  \item Consumers maximize utility subject to their budget constaints:
    \[
    (x^{i*}, G^*) = \arg \max_{x^i, G} u^i(x^i, G)
    \quad s.t. \quad  x^i + p^{i*}G^* \leq w^i + s^i \pi(G^*) 
    \]
  \item Market clears:
    \[
    \sum_i x^{i*} + f^{-1}(G^*) \leq \sum_i w^i
    \]
  \end{enumerate}
  where $f^{-1}(G)$ is the cost in inputs to produce $G$.

\end{definition}

\begin{prop}
  Any Lindahl equilibrium is Pareto optimal.
\end{prop}

Note: by the definition of personalized price in the Lindahl
equilibrium, an agent will not behave competitively. He will have an
incentive to misreport his desire for the public good. Moreover, this
equilibrium requires perfect excludability and also perfect ability to
price discriminate on the public good. Thus this should be thought of
as a normative benchmark, and the conclusion should be that market
mechanisms are unlikely to provide public goods efficiently; this
provides a rationale for government involvement.
